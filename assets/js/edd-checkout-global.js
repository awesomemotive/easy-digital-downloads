(()=>{var e={1669:e=>{"use strict";e.exports=jQuery},5313:()=>{const e=document.getElementById("edd_purchase_form");e&&e.addEventListener("change",(function(e){"edd_email"===e.target.name&&e.target.value&&function(e){var t=e.value;if(t){var a=new FormData;a.append("action","edd_check_email"),a.append("email",t),fetch(edd_global_vars.ajaxurl,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(t){let a="";t.success||(a=t.data.message),e.setCustomValidity(a),e.reportValidity()}))}}(e.target)}))}},t={};function a(d){var n=t[d];if(void 0!==n)return n.exports;var o=t[d]={exports:{}};return e[d](o,o.exports,a),o.exports}(()=>{"use strict";var e,t=a(1669),d=a(1669);e=()=>{d(document.body).on("click",".edd_terms_links",(function(e){e.preventDefault();const t=d(this).parent();t.prev(".edd-terms").slideToggle(),t.find(".edd_terms_links").toggle()}))},function(t){t(e)}(t),a(5313);var n=a(1669);let o=0;function r(e){if("1"!=edd_global_vars.taxes_enabled)return;const t=document.getElementById("edd_checkout_cart");if(!t)return;let a=t.getElementsByClassName("edd_cart_tax"),d=0;if(a.length>0&&!a[0].querySelector(".edd-recalculate-taxes-loading")){a=a[0];const e=document.createElement("span"),t=a.getElementsByClassName("edd_cart_tax_amount");for(let e=0;e<t.length;e++)d=t[e].dataset.tax,t[e].remove();e.classList.add("edd-loading-ajax","edd-recalculate-taxes-loading","edd-loading"),a.appendChild(e)}const r=n("#edd_cc_address"),c=r.find("#billing_country").val(),s=r.find("#card_address").val(),l=r.find("#card_address_2").val(),i=r.find("#card_city").val(),u=r.find("#card_state").val();e||(e=u);const _={action:"edd_recalculate_taxes",card_address:s,card_address_2:l,card_city:i,card_zip:r.find("#card_zip").val(),state:e,billing_country:c,nonce:n("#edd-checkout-address-fields-nonce").val(),current_page:edd_global_vars.current_page,current_tax_amount:d},p=++o;return n.ajax({type:"POST",data:_,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(e){if(p===o){e.html&&n("#edd_checkout_cart_form").replaceWith(e.html),n(".edd_cart_amount").html(e.total);const t=new Object;t.postdata=_,t.response=e,n("body").trigger("edd_taxes_recalculated",[t])}n(".edd-recalculate-taxes-loading").remove()}}).fail((function(e){window.console&&window.console.log&&(console.log(e),p===o&&n("body").trigger("edd_taxes_recalculated",[tax_data]))}))}window.recalculate_taxes=r,window.EDD_Checkout=function(e){let t,a,d,n,o;function c(a){a.preventDefault();const d=e("#edd-discount").val(),n=e("#edd-discount-loader"),c=e("#edd_cc_address .edd-input, #edd_cc_address .edd-select").filter("[required]");if(""==d||d==edd_global_vars.enter_discount)return!1;const s={action:"edd_apply_discount",code:d,form:e("#edd_purchase_form").serialize(),current_page:edd_global_vars.current_page};return e("#edd-discount-error-wrap").html("").hide(),n.show(),e.ajax({type:"POST",data:s,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(a){a?"valid"==a.msg?(e(".edd_cart_discount").html(a.html),e(".edd_cart_discount_row").show(),e(".edd_cart_amount").each((function(){e(this).text(a.total).data("subtotal",a.subtotal_raw).attr("data-subtotal",a.subtotal_raw).data("total",a.total_plain).attr("data-total",a.total_plain)})),e("#edd-discount",o).val(""),r(),"0.00"==a.total_plain?(e("#edd_cc_fields,#edd_cc_address,#edd_payment_mode_select").slideUp(),c.prop("required",!1),e('input[name="edd-gateway"]').val("manual")):(c.prop("required",!0),e("#edd_cc_fields,#edd_cc_address").slideDown()),e("#edd-purchase-button").val(a.complete_purchase),t.trigger("edd_discount_applied",[a])):(e("#edd-discount-error-wrap").html('<span class="edd_error">'+a.msg+"</span>"),e("#edd-discount-error-wrap").show(),t.trigger("edd_discount_invalid",[a])):(window.console&&window.console.log&&console.log(a),t.trigger("edd_discount_failed",[a])),n.hide()}}).fail((function(e){window.console&&window.console.log&&console.log(e)})),!1}function s(a){const d={action:"edd_remove_discount",code:e(this).data("code"),current_page:edd_global_vars.current_page};return e.ajax({type:"POST",data:d,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(a){const d="0"+edd_global_vars.decimal_separator+"00";e(".edd_cart_amount").each((function(){edd_global_vars.currency_sign+d!=e(this).text()&&d+edd_global_vars.currency_sign!=e(this).text()||window.location.reload(),e(this).text(a.total).data("subtotal",a.subtotal_raw).attr("data-subtotal",a.subtotal_raw).data("total",a.total_plain).attr("data-total",a.total_plain)})),e(".edd_cart_discount").html(a.html),a.discounts&&0===a.discounts.length&&e(".edd_cart_discount_row").hide(),r(),e("#edd_cc_fields,#edd_cc_address").slideDown(),e("#edd-purchase-button").val(a.complete_purchase),t.trigger("edd_discount_removed",[a])}}).fail((function(e){window.console&&window.console.log&&console.log(e)})),!1}function l(a){const d=e(this),n=d.val(),o=d.data("key"),r=d.closest(".edd_cart_item").data("download-id"),c=d.parent().find('input[name="edd-cart-download-'+o+'-options"]').val(),s=e("#edd_cc_address"),l={action:"edd_update_quantity",quantity:n,download_id:r,options:c,billing_country:s.find("#billing_country").val(),card_state:s.find("#card_state").val(),current_page:edd_global_vars.current_page};return e.ajax({type:"POST",data:l,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(a){e(".edd_cart_subtotal_amount").each((function(){e(this).text(a.subtotal)})),e(".edd_cart_tax_amount").each((function(){e(this).text(a.taxes).data("tax",a.taxes_raw).attr("data-tax",a.taxes_raw)})),e(".edd_cart_discount").html(a.discounts),e(".edd_cart_amount").each((function(){e(this).text(a.total).data("subtotal",a.subtotal_raw).attr("data-subtotal",a.subtotal_raw).data("total",a.total_raw).attr("data-total",a.total_raw),t.trigger("edd_quantity_updated",[a])})),e("#edd-purchase-button").val(a.complete_purchase)}}).fail((function(e){window.console&&window.console.log&&console.log(e)})),!1}return{init:function(){t=e(document.body),a=e("#edd_purchase_form"),d=e(".edd_cart_amount"),n=d.text(),o=e("#edd_checkout_form_wrap"),t.on("edd_gateway_loaded",(function(e){!function(e){const t=e.find(".card-number"),a=e.find(".card-cvc"),d=e.find(".card-expiry");t.length&&"function"==typeof t.payment&&(t.payment("formatCardNumber"),a.payment("formatCardCVC"),d.payment("formatCardExpiry"))}(a)})),t.on("keyup change",".edd-do-validate .card-number",(function(){!function(t){const a=t;a.validateCreditCard((function(t){const d=e(".card-type");null==t.card_type?(d.removeClass().addClass("off card-type"),a.removeClass("valid"),a.addClass("error")):(d.removeClass("off"),d.html((e=>{let t,a=e;return"amex"===e?(a="americanexpress",t=32):t=50,`\n    <svg\n      width=${t}\n      height=32\n      class="payment-icon icon-${a}"\n      role="img"\n    >\n      <use\n        href="#icon-${a}"\n        xlink:href="#icon-${a}">\n      </use>\n    </svg>`})(t.card_type.name)),d.addClass(t.card_type.name),t.length_valid&&t.luhn_valid?(a.addClass("valid"),a.removeClass("error")):(a.removeClass("valid"),a.addClass("error")))}))}(e(this))})),t.on("blur change",".card-name",(function(){const t=e(this);t.validateCreditCard((function(a){null!=a.card_type?(t.removeClass("valid").addClass("error"),e("#edd-purchase-button").attr("disabled","disabled")):(t.removeClass("error").addClass("valid"),e("#edd-purchase-button").removeAttr("disabled"))}))})),t.on("submit","#edd_payment_mode",(function(){if(0==e("#edd-gateway option:selected").val())return alert(edd_global_vars.no_gateway),!1})),t.on("click","#edd_payment_mode_select input",(function(){e("#edd_payment_mode_select label.edd-gateway-option-selected").removeClass("edd-gateway-option-selected"),e("#edd_payment_mode_select input:checked").parent().addClass("edd-gateway-option-selected")})),o.on("click",".edd-apply-discount",c),o.on("keypress","#edd-discount",(function(e){if("13"==e.keyCode)return!1})),o.on("keyup","#edd-discount",(function(e){"13"==e.keyCode&&o.find(".edd-apply-discount").trigger("click")})),t.on("click",".edd_discount_remove",s),t.on("click",".edd_discount_link",(function(t){t.preventDefault(),e(".edd_discount_link").parent().hide(),e("#edd-discount-code-wrap").show().find("#edd-discount").focus()})),t.find("#edd-discount-code-wrap").hide(),t.find("#edd_show_discount").show(),t.on("change",".edd-item-quantity",l),t.on("click",".edd-amazon-logout #Logout",(function(e){e.preventDefault(),amazon.Login.logout(),window.location=edd_amazon.checkoutUri}))},recalculate_taxes:r}}(window.jQuery),window.jQuery(document).ready(EDD_Checkout.init)})()})();