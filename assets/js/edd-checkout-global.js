(()=>{"use strict";var e={311:e=>{e.exports=jQuery}},d={};function t(a){var n=d[a];if(void 0!==n)return n.exports;var o=d[a]={exports:{}};return e[a](o,o.exports,t),o.exports}(()=>{var e,d=t(311),a=t(311);e=()=>{a(document.body).on("click",".edd_terms_links",(function(e){e.preventDefault();const d=a(this).parent();d.prev(".edd-terms").slideToggle(),d.find(".edd_terms_links").toggle()}))},function(d){d(e)}(d);var n=t(311);let o=0;function c(e){if("1"!=edd_global_vars.taxes_enabled)return;const d=n("#edd_cc_address"),t=d.find("#billing_country").val(),a=d.find("#card_address").val(),c=d.find("#card_address_2").val(),i=d.find("#card_city").val(),r=d.find("#card_state").val();e||(e=r);const s={action:"edd_recalculate_taxes",card_address:a,card_address_2:c,card_city:i,card_zip:d.find("#card_zip").val(),state:e,billing_country:t,nonce:n("#edd-checkout-address-fields-nonce").val()};n("#edd_purchase_submit [type=submit]").after('<span class="edd-loading-ajax edd-recalculate-taxes-loading edd-loading"></span>');const l=++o;return n.ajax({type:"POST",data:s,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(e){if(l===o){e.html&&n("#edd_checkout_cart_form").replaceWith(e.html),n(".edd_cart_amount").html(e.total);const d=new Object;d.postdata=s,d.response=e,n("body").trigger("edd_taxes_recalculated",[d])}n(".edd-recalculate-taxes-loading").remove()}}).fail((function(e){window.console&&window.console.log&&(console.log(e),l===o&&n("body").trigger("edd_taxes_recalculated",[tax_data]))}))}window.recalculate_taxes=c,window.EDD_Checkout=function(e){let d,t,a,n,o;function i(t){t.preventDefault();const a=e("#edd-discount").val(),n=e("#edd-discount-loader"),i=e("#edd_cc_address .edd-input, #edd_cc_address .edd-select").filter("[required]");if(""==a||a==edd_global_vars.enter_discount)return!1;const r={action:"edd_apply_discount",code:a,form:e("#edd_purchase_form").serialize()};return e("#edd-discount-error-wrap").html("").hide(),n.show(),e.ajax({type:"POST",data:r,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(t){t?"valid"==t.msg?(e(".edd_cart_discount").html(t.html),e(".edd_cart_discount_row").show(),e(".edd_cart_amount").each((function(){e(this).text(t.total),e(this).data("total",t.total_plain)})),e("#edd-discount",o).val(""),c(),"0.00"==t.total_plain?(e("#edd_cc_fields,#edd_cc_address,#edd_payment_mode_select").slideUp(),i.prop("required",!1),e('input[name="edd-gateway"]').val("manual")):(i.prop("required",!0),e("#edd_cc_fields,#edd_cc_address").slideDown()),d.trigger("edd_discount_applied",[t])):(e("#edd-discount-error-wrap").html('<span class="edd_error">'+t.msg+"</span>"),e("#edd-discount-error-wrap").show(),d.trigger("edd_discount_invalid",[t])):(window.console&&window.console.log&&console.log(t),d.trigger("edd_discount_failed",[t])),n.hide()}}).fail((function(e){window.console&&window.console.log&&console.log(e)})),!1}function r(t){const a={action:"edd_remove_discount",code:e(this).data("code")};return e.ajax({type:"POST",data:a,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(t){const a="0"+edd_global_vars.decimal_separator+"00";e(".edd_cart_amount").each((function(){edd_global_vars.currency_sign+a!=e(this).text()&&a+edd_global_vars.currency_sign!=e(this).text()||window.location.reload(),e(this).text(t.total),e(this).data("total",t.total_plain)})),e(".edd_cart_discount").html(t.html),t.discounts&&0===t.discounts.length&&e(".edd_cart_discount_row").hide(),c(),e("#edd_cc_fields,#edd_cc_address").slideDown(),d.trigger("edd_discount_removed",[t])}}).fail((function(e){window.console&&window.console.log&&console.log(e)})),!1}function s(t){const a=e(this),n=a.val(),o=a.data("key"),c=a.closest(".edd_cart_item").data("download-id"),i=a.parent().find('input[name="edd-cart-download-'+o+'-options"]').val(),r=e("#edd_cc_address"),s={action:"edd_update_quantity",quantity:n,download_id:c,options:i,billing_country:r.find("#billing_country").val(),card_state:r.find("#card_state").val()};return e.ajax({type:"POST",data:s,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(t){e(".edd_cart_subtotal_amount").each((function(){e(this).text(t.subtotal)})),e(".edd_cart_tax_amount").each((function(){e(this).text(t.taxes)})),e(".edd_cart_amount").each((function(){e(this).text(t.total),d.trigger("edd_quantity_updated",[t])}))}}).fail((function(e){window.console&&window.console.log&&console.log(e)})),!1}return{init:function(){d=e(document.body),t=e("#edd_purchase_form"),a=e(".edd_cart_amount"),n=a.text(),o=e("#edd_checkout_form_wrap"),d.on("edd_gateway_loaded",(function(e){!function(e){const d=e.find(".card-number"),t=e.find(".card-cvc"),a=e.find(".card-expiry");d.length&&"function"==typeof d.payment&&(d.payment("formatCardNumber"),t.payment("formatCardCVC"),a.payment("formatCardExpiry"))}(t)})),d.on("keyup change",".edd-do-validate .card-number",(function(){!function(d){const t=d;t.validateCreditCard((function(d){const a=e(".card-type");null==d.card_type?(a.removeClass().addClass("off card-type"),t.removeClass("valid"),t.addClass("error")):(a.removeClass("off"),a.html((e=>{let d,t=e;return"amex"===e?(t="americanexpress",d=32):d=50,`\n    <svg\n      width=${d}\n      height=32\n      class="payment-icon icon-${t}"\n      role="img"\n    >\n      <use\n        href="#icon-${t}"\n        xlink:href="#icon-${t}">\n      </use>\n    </svg>`})(d.card_type.name)),a.addClass(d.card_type.name),d.length_valid&&d.luhn_valid?(t.addClass("valid"),t.removeClass("error")):(t.removeClass("valid"),t.addClass("error")))}))}(e(this))})),d.on("blur change",".card-name",(function(){const d=e(this);d.validateCreditCard((function(t){null!=t.card_type?(d.removeClass("valid").addClass("error"),e("#edd-purchase-button").attr("disabled","disabled")):(d.removeClass("error").addClass("valid"),e("#edd-purchase-button").removeAttr("disabled"))}))})),d.on("submit","#edd_payment_mode",(function(){if(0==e("#edd-gateway option:selected").val())return alert(edd_global_vars.no_gateway),!1})),d.on("click","#edd_payment_mode_select input",(function(){e("#edd_payment_mode_select label.edd-gateway-option-selected").removeClass("edd-gateway-option-selected"),e("#edd_payment_mode_select input:checked").parent().addClass("edd-gateway-option-selected")})),o.on("click",".edd-apply-discount",i),o.on("keypress","#edd-discount",(function(e){if("13"==e.keyCode)return!1})),o.on("keyup","#edd-discount",(function(e){"13"==e.keyCode&&o.find(".edd-apply-discount").trigger("click")})),d.on("click",".edd_discount_remove",r),d.on("click",".edd_discount_link",(function(d){d.preventDefault(),e(".edd_discount_link").parent().hide(),e("#edd-discount-code-wrap").show().find("#edd-discount").focus()})),d.find("#edd-discount-code-wrap").hide(),d.find("#edd_show_discount").show(),d.on("change",".edd-item-quantity",s),d.on("click",".edd-amazon-logout #Logout",(function(e){e.preventDefault(),amazon.Login.logout(),window.location=edd_amazon.checkoutUri}))},recalculate_taxes:c}}(window.jQuery),window.jQuery(document).ready(EDD_Checkout.init)})()})();