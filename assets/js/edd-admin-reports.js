(()=>{"use strict";var e={1669:e=>{e.exports=jQuery},9431:e=>{e.exports=function(e,t,a,o){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,r=isFinite(+t)?Math.abs(t):0,s=void 0===o?",":o,i=void 0===a?".":a,d="";return d=(r?function(e,t){if(-1===(""+e).indexOf("e"))return+(Math.round(e+"e+"+t)+"e-"+t);var a=(""+e).split("e"),o="";return+a[1]+t>0&&(o="+"),(+(Math.round(+a[0]+"e"+o+(+a[1]+t))+"e-"+t)).toFixed(t)}(n,r).toString():""+Math.round(n)).split("."),d[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(d[1]||"").length<r&&(d[1]=d[1]||"",d[1]+=new Array(r-d[1].length+1).join("0")),d.join(i)}}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,a),r.exports}a(1669);const o=a(9431),n=class{constructor(e={}){const{currency_decimals:t,decimal_separator:a,thousands_separator:o}=edd_vars;this.config={precision:t,decimalSeparator:a,thousandSeparator:o,...e}}format(e){let t=e;"number"!=typeof e&&(t=parseFloat(e)),isNaN(t)&&(t=0);const{precision:a,decimalSeparator:n,thousandSeparator:r}=this.config;return o(t,a,n,r)}unformat(e){const{decimalSeparator:t,thousandSeparator:a}=this.config;"string"!=typeof e&&(e=String(e));const o=e.replace(a,"").replace(t,"."),n=parseFloat(o);return isNaN(n)?0:n}absint(e){const t=this.unformat(e);return t>=0?t:-1*t}},r=class{constructor(e={}){const{currency:t,currency_sign:a,currency_pos:o,currency_decimals:r,decimal_separator:s,thousands_separator:i}=edd_vars;this.config={currency:t,currencySymbol:a,currencySymbolPosition:o,precision:r,decimalSeparator:s,thousandSeparator:i,...e},this.number=new n(this.config)}format(e,t=!0){const{currencySymbol:a,currencySymbolPosition:o}=this.config,n=e<0;let r=this.number.format(e),s="";switch(n&&(r=this.number.format(-1*e)),o){case"before":s=a+r;break;case"after":s=r+a}return!0===n&&!1===t&&(s=`-${s}`),s}unformat(e){const{currencySymbol:t}=this.config,a=e.replace(t,"");return this.number.unformat(a)}},s=(e,t)=>{let a=e;const{type:o}=t;return"currency"===o&&(a=(new r).format(e,!1)),a},i={enabled:!1,intersect:!1,mode:"index",custom:function(e){let t=document.getElementById(this._chart.canvas.parentNode.id+"-tooltip");if(t||(t=document.createElement("div"),t.id=this._chart.canvas.parentNode.id+"-tooltip",t.classList.add("edd-chartjs-tooltip"),t.innerHTML="<table></table>",this._chart.canvas.parentNode.appendChild(t)),0===e.opacity)return void(t.style.opacity=0);if(e.body){const a=e.title||[],o=e.body.map((function(e){return e.lines}));let n="<thead>"+a+"</thead>";n+="<tbody>",o.forEach((function(t,a){const o=e.labelColors[a],{borderColor:r,backgroundColor:s}=o;let i=r;"rgb(230, 230, 230)"!==i&&"#fff"!==i||(i=s);const d='<span class="edd-chartjs-tooltip-key" style="'+[`background: ${i}`,`border-color: ${i}`,"border-width: 2px"].join(";")+'"></span>';n+="<tr><td>"+d+t+"</td></tr>"})),n+="</tbody>",t.querySelector("table").innerHTML=n}const a=this._chart.canvas.getBoundingClientRect();let o=t.getBoundingClientRect();const n=this._chart.canvas.offsetLeft+e.caretX;let r=n;r=n>=a.width/2?n-o.width/2-20:n+o.width/2+20,t.style.left=r+"px";const s=this._chart.canvas.offsetTop+Math.round(this._chart.canvas.height/5);t.style.top=s+"px",t.style.fontFamily=e._bodyFontFamily,t.style.fontSize=e.bodyFontSize+"px",t.style.fontStyle=e._bodyFontStyle,t.style.opacity=1}},d=e=>{const{target:t}=e,{dates:{utc_offset:a,hour_by_hour:o,day_by_day:r}}=e;e.options.scales.yAxes.forEach((e=>{e.ticks.hasOwnProperty("formattingType")&&(e.ticks=(e=>{const t=new n;return e.callback=function(a,o,n){switch(e.formattingType){case"integer":a=parseInt(a);break;case"format":a=t.format(a)}return a},e})(e.ticks)),e.ticks.hasOwnProperty("hideNegativeTicks")&&e.ticks.hideNegativeTicks&&(e.afterTickToLabelConversion=function(e){for(let t=e.ticksAsNumbers.length-1;t>=0;t--)e.ticksAsNumbers[t]<0&&(e.ticksAsNumbers.splice(t,1),e.ticks.splice(t,1))})}));const s={...e,options:{...e.options,maintainAspectRatio:!1,tooltips:c(e),scales:{yAxes:[...e.options.scales.yAxes],xAxes:[{...e.options.scales.xAxes[0],ticks:{maxTicksLimit:12,autoSkip:!0,maxRotation:45},time:{...e.options.scales.xAxes[0].time,parser:function(e){return o||r?window.moment(e).utcOffset(a):window.moment.utc(e)}}}]},legend:{onClick:function(e,t){const a=this.chart.config.data.datasets[t.datasetIndex];if(a.hasOwnProperty("yAxisID")){const e=this.chart.options.scales.yAxes.findIndex((e=>e.id===a.yAxisID));-1!==e&&(this.chart.options.scales.yAxes[e].display=!this.chart.options.scales.yAxes[e].display)}a.hidden=!a.hidden,this.chart.update()}}}};let i=document.getElementById(t),d=new Chart(i,s),l=[];for(const[e,t]of Object.entries(d.scales))"time"!==t.type&&l.push(t);if(l.length>1){l.forEach((e=>{e.range=e.max-e.min,e.min_ratio=e.min/e.range,e.max_ratio=e.max/e.range}));let e=l.reduce(((e,t)=>({min_ratio:Math.min(e.min_ratio,t.min_ratio),max_ratio:Math.max(e.max_ratio,t.max_ratio)})));l.forEach((t=>{let a=e.min_ratio*t.range,o=e.max_ratio*t.range,n=d.options.scales.yAxes.find((e=>e.id===t.id));n&&(n.ticks.min=a,n.ticks.max=o)})),d.update()}return d},c=e=>({...i,callbacks:{label:function(t,a){const{options:{datasets:o}}=e,n=o[Object.keys(o)[t.datasetIndex]],r=s(t.yLabel,n);return`${a.datasets[t.datasetIndex].label}: ${r}`}}});window.edd=window.edd||{},window.edd.renderChart=e=>{(e=>{const{type:t}=e;return"pie"===t||"doughnut"===t})(e)?(e=>{const{target:t}=e;e.options.tooltips=(e=>({...i,callbacks:{label:function(t,a){const{options:{datasets:o}}=e,n=a.datasets[t.datasetIndex],r=Object.values(o).find((e=>e.label&&e.label.toLowerCase()===n.label.toLowerCase())),i=n.data.reduce((function(e,t,a,o){return e+t})),d=n.data[t.index],c=s(d,r),l=Math.floor(d/i*100+.5);return`${a.labels[t.index]}: ${c} (${l}%)`}}}))(e),new Chart(document.getElementById(t),e)})(e):d(e)};var l=a(1669),p=a(1669);"undefined"!=typeof postboxes&&/edd-reports/.test(pagenow)&&postboxes.add_postbox_toggles(pagenow);const u={init:function(){this.meta_boxes(),this.date_options(),this.customers_export()},meta_boxes:function(){l(".edd-reports-wrapper .postbox .handlediv").remove(),l(".edd-reports-wrapper .postbox").removeClass("closed"),setTimeout((function(){l(".edd-reports-wrapper .postbox .hndle").off("click.postboxes")}),1)},date_options:function(){l("select.edd-graphs-date-options").on("change",(function(e){const t=l(this),a=t.parent().siblings(".edd-date-range-options");"other"===t.val()?a.removeClass("screen-reader-text"):(a.addClass("screen-reader-text"),l(".edd-date-range-selected-date span").addClass("hidden"),l('.edd-date-range-selected-date span[data-range="'+t.val()+'"]').removeClass("hidden"))})),l(".edd-date-range-dates").on("click",(function(e){e.preventDefault(),l("select.edd-graphs-date-options").trigger("focus")}));const e=l(".edd-date-range-selected-relative-date"),t=l(".edd-date-range-relative-dropdown");l(".edd-graphs-date-options").on("change",(function(){var e=l(this).val(),a=l('.edd-date-range-selected-date span[data-range="'+e+'"]').data("default-relative-range");l(".edd-date-range-picker").attr("data-range",e),l(".edd-graphs-relative-date-options").val(a).trigger("change"),l.ajax({type:"GET",dataType:"html",url:ajaxurl,data:{action:"edd_reports_get_relative_date_ranges",range:e,relative_range:a},beforeSend:function(){t.html('<div class="spinner"></div>').addClass("loading")},success:function(e){t.html(e)}}).fail((function(e){window.console&&window.console.log&&console.log(e)})).done((function(e){t.remove(".spinner"),t.removeClass("loading")}))})),e.on("click",(function(e){e.preventDefault(),l(this).toggleClass("opened")})),l(document).on("click",".edd-date-range-relative-dropdown li",(function(){var e=l(this).data("range");l(".edd-graphs-relative-date-options").val(e).trigger("change")})),l(".edd-graphs-relative-date-options").on("change",(function(){var e=l(this).val(),t=l('.edd-date-range-relative-dropdown li[data-range="'+e+'"]'),a=t.find(".date-range-name").first().text();l(".edd-date-range-selected-relative-range-name").html(a),l(".edd-date-range-relative-dropdown li.active").removeClass("active"),t.addClass("active")})),l(document).on("click",(function(e){u.close_relative_ranges_dropdown(e.target)})),l(document).on("keydown",(function(e){"Escape"===e.key&&u.close_relative_ranges_dropdown()}))},close_relative_ranges_dropdown:function(e=!1){var t=l(".edd-date-range-selected-relative-date");if(!t.hasClass("opened"))return!1;!1!==e&&(t.is(e)||t.has(e).length)||t.removeClass("opened")},customers_export:function(){l("#edd_customer_export_download").on("change",(function(){const e=l(this),t=l("option:selected",e).val(),a=l("#edd_customer_export_option");if("0"===e.val()?a.show():a.hide(),0!==parseInt(t)){const e={action:"edd_check_for_download_price_variations",download_id:t,all_prices:!0};var o=l(".edd_price_options_select");l.post(ajaxurl,e,(function(e){o.remove(),l("#edd_customer_export_download_chosen").after(e)}))}else o.remove()}))}};p(document).ready((function(e){u.init()}))})();