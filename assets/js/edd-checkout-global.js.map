{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"jQuery\"","webpack:///./assets/js/frontend/checkout/index.js","webpack:///./assets/js/frontend/checkout/utils.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","jQuery","window","recalculate_taxes","recalculateTaxes","EDD_Checkout","$","$body","$form","$edd_cart_amount","$checkout_form_wrap","apply_discount","event","preventDefault","this","discount_code","val","edd_discount_loader","edd_global_vars","enter_discount","postData","action","code","form","serialize","html","hide","show","ajax","type","data","dataType","url","ajaxurl","xhrFields","withCredentials","success","discount_response","msg","each","text","total","total_plain","inputs","slideUp","removeAttr","is","attr","slideDown","trigger","console","log","fail","remove_discount","zero","decimal_separator","currency_sign","location","reload","discounts","length","update_item_quantities","$this","quantity","download_id","closest","options","parent","find","edd_cc_address","billing_country","card_state","response","subtotal","taxes","init","document","body","on","e","card_number","card_cvc","card_expiry","payment","field","card_field","validateCreditCard","result","$card_type","card_type","removeClass","addClass","getCreditCardIcon","length_valid","luhn_valid","name_field","alert","no_gateway","keyCode","focus","amazon","Login","logout","edd_amazon","checkoutUri","ready","width","ajax_tax_count","state","taxes_enabled","$edd_cc_address","card_address","card_address_2","card_city","card_zip","nonce","after","current_ajax_count","tax_response","replaceWith","tax_data","postdata","remove"],"mappings":"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","file":"assets/js/edd-checkout-global.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 71);\n","module.exports = jQuery;","/**\n * Internal dependencies.\n */\nimport { getCreditCardIcon, recalculateTaxes } from './utils.js';\n\n// Backwards compatibility. Assign function to global namespace.\nwindow.recalculate_taxes = recalculateTaxes;\n\nwindow.EDD_Checkout = ( function( $ ) {\n\t'use strict';\n\n\tlet $body,\n\t\t$form,\n\t\t$edd_cart_amount,\n\t\tbefore_discount,\n\t\t$checkout_form_wrap;\n\n\tfunction init() {\n\t\t$body = $( document.body );\n\t\t$form = $( '#edd_purchase_form' );\n\t\t$edd_cart_amount = $( '.edd_cart_amount' );\n\t\tbefore_discount = $edd_cart_amount.text();\n\t\t$checkout_form_wrap = $( '#edd_checkout_form_wrap' );\n\n\t\t$body.on( 'edd_gateway_loaded', function( e ) {\n\t\t\tedd_format_card_number( $form );\n\t\t} );\n\n\t\t$body.on( 'keyup change', '.edd-do-validate .card-number', function() {\n\t\t\tedd_validate_card( $( this ) );\n\t\t} );\n\n\t\t$body.on( 'blur change', '.card-name', function() {\n\t\t\tconst name_field = $( this );\n\n\t\t\tname_field.validateCreditCard( function( result ) {\n\t\t\t\tif ( result.card_type != null ) {\n\t\t\t\t\tname_field.removeClass( 'valid' ).addClass( 'error' );\n\t\t\t\t\t$( '#edd-purchase-button' ).attr( 'disabled', 'disabled' );\n\t\t\t\t} else {\n\t\t\t\t\tname_field.removeClass( 'error' ).addClass( 'valid' );\n\t\t\t\t\t$( '#edd-purchase-button' ).removeAttr( 'disabled' );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\n\t\t// Make sure a gateway is selected\n\t\t$body.on( 'submit', '#edd_payment_mode', function() {\n\t\t\tconst gateway = $( '#edd-gateway option:selected' ).val();\n\t\t\tif ( gateway == 0 ) {\n\t\t\t\talert( edd_global_vars.no_gateway );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\n\t\t// Add a class to the currently selected gateway on click\n\t\t$body.on( 'click', '#edd_payment_mode_select input', function() {\n\t\t\t$( '#edd_payment_mode_select label.edd-gateway-option-selected' ).removeClass( 'edd-gateway-option-selected' );\n\t\t\t$( '#edd_payment_mode_select input:checked' ).parent().addClass( 'edd-gateway-option-selected' );\n\t\t} );\n\n\t\t// Validate and apply a discount\n\t\t$checkout_form_wrap.on( 'click', '.edd-apply-discount', apply_discount );\n\n\t\t// Prevent the checkout form from submitting when hitting Enter in the discount field\n\t\t$checkout_form_wrap.on( 'keypress', '#edd-discount', function( event ) {\n\t\t\tif ( event.keyCode == '13' ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\n\t\t// Apply the discount when hitting Enter in the discount field instead\n\t\t$checkout_form_wrap.on( 'keyup', '#edd-discount', function( event ) {\n\t\t\tif ( event.keyCode == '13' ) {\n\t\t\t\t$checkout_form_wrap.find( '.edd-apply-discount' ).trigger( 'click' );\n\t\t\t}\n\t\t} );\n\n\t\t// Remove a discount\n\t\t$body.on( 'click', '.edd_discount_remove', remove_discount );\n\n\t\t// When discount link is clicked, hide the link, then show the discount input and set focus.\n\t\t$body.on( 'click', '.edd_discount_link', function( e ) {\n\t\t\te.preventDefault();\n\t\t\t$( '.edd_discount_link' ).parent().hide();\n\t\t\t$( '#edd-discount-code-wrap' ).show().find( '#edd-discount' ).focus();\n\t\t} );\n\n\t\t// Hide / show discount fields for browsers without javascript enabled\n\t\t$body.find( '#edd-discount-code-wrap' ).hide();\n\t\t$body.find( '#edd_show_discount' ).show();\n\n\t\t// Update the checkout when item quantities are updated\n\t\t$body.on( 'change', '.edd-item-quantity', update_item_quantities );\n\n\t\t$body.on( 'click', '.edd-amazon-logout #Logout', function( e ) {\n\t\t\te.preventDefault();\n\t\t\tamazon.Login.logout();\n\t\t\twindow.location = edd_amazon.checkoutUri;\n\t\t} );\n\t}\n\n\tfunction edd_validate_card( field ) {\n\t\tconst card_field = field;\n\t\tcard_field.validateCreditCard( function( result ) {\n\t\t\tconst $card_type = $( '.card-type' );\n\n\t\t\tif ( result.card_type == null ) {\n\t\t\t\t$card_type.removeClass().addClass( 'off card-type' );\n\t\t\t\tcard_field.removeClass( 'valid' );\n\t\t\t\tcard_field.addClass( 'error' );\n\t\t\t} else {\n\t\t\t\t$card_type.removeClass( 'off' );\n\t\t\t\t$card_type.html( getCreditCardIcon( result.card_type.name ) );\n\t\t\t\t$card_type.addClass( result.card_type.name );\n\t\t\t\tif ( result.length_valid && result.luhn_valid ) {\n\t\t\t\t\tcard_field.addClass( 'valid' );\n\t\t\t\t\tcard_field.removeClass( 'error' );\n\t\t\t\t} else {\n\t\t\t\t\tcard_field.removeClass( 'valid' );\n\t\t\t\t\tcard_field.addClass( 'error' );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tfunction edd_format_card_number( form ) {\n\t\tconst card_number = form.find( '.card-number' ),\n\t\t\tcard_cvc = form.find( '.card-cvc' ),\n\t\t\tcard_expiry = form.find( '.card-expiry' );\n\n\t\tif ( card_number.length && 'function' === typeof card_number.payment ) {\n\t\t\tcard_number.payment( 'formatCardNumber' );\n\t\t\tcard_cvc.payment( 'formatCardCVC' );\n\t\t\tcard_expiry.payment( 'formatCardExpiry' );\n\t\t}\n\t}\n\n\tfunction apply_discount( event ) {\n\t\tevent.preventDefault();\n\n\t\tconst $this = $( this ),\n\t\t\tdiscount_code = $( '#edd-discount' ).val(),\n\t\t\tedd_discount_loader = $( '#edd-discount-loader' );\n\n\t\tif ( discount_code == '' || discount_code == edd_global_vars.enter_discount ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst postData = {\n\t\t\taction: 'edd_apply_discount',\n\t\t\tcode: discount_code,\n\t\t\tform: $( '#edd_purchase_form' ).serialize(),\n\t\t};\n\n\t\t$( '#edd-discount-error-wrap' ).html( '' ).hide();\n\t\tedd_discount_loader.show();\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\tdata: postData,\n\t\t\tdataType: 'json',\n\t\t\turl: edd_global_vars.ajaxurl,\n\t\t\txhrFields: {\n\t\t\t\twithCredentials: true,\n\t\t\t},\n\t\t\tsuccess: function( discount_response ) {\n\t\t\t\tif ( discount_response ) {\n\t\t\t\t\tif ( discount_response.msg == 'valid' ) {\n\t\t\t\t\t\t$( '.edd_cart_discount' ).html( discount_response.html );\n\t\t\t\t\t\t$( '.edd_cart_discount_row' ).show();\n\n\t\t\t\t\t\t$( '.edd_cart_amount' ).each( function() {\n\t\t\t\t\t\t\t// Format discounted amount for display.\n\t\t\t\t\t\t\t$( this ).text( discount_response.total );\n\t\t\t\t\t\t\t// Set data attribute to new (unformatted) discounted amount.'\n\t\t\t\t\t\t\t$( this ).data( 'total', discount_response.total_plain );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$( '#edd-discount', $checkout_form_wrap ).val( '' );\n\n\t\t\t\t\t\trecalculateTaxes();\n\n\t\t\t\t\t\tconst inputs = $( '#edd_cc_fields .edd-input, #edd_cc_fields .edd-select,#edd_cc_address .edd-input, #edd_cc_address .edd-select,#edd_payment_mode_select .edd-input, #edd_payment_mode_select .edd-select' );\n\n\t\t\t\t\t\tif ( '0.00' == discount_response.total_plain ) {\n\t\t\t\t\t\t\t$( '#edd_cc_fields,#edd_cc_address,#edd_payment_mode_select' ).slideUp();\n\t\t\t\t\t\t\tinputs.removeAttr( 'required' );\n\t\t\t\t\t\t\t$( 'input[name=\"edd-gateway\"]' ).val( 'manual' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif ( ! inputs.is( '.card-address-2' ) ) {\n\t\t\t\t\t\t\t\tinputs.attr( 'required', 'required' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$( '#edd_cc_fields,#edd_cc_address' ).slideDown();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$body.trigger( 'edd_discount_applied', [ discount_response ] );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( '#edd-discount-error-wrap' ).html( '<span class=\"edd_error\">' + discount_response.msg + '</span>' );\n\t\t\t\t\t\t$( '#edd-discount-error-wrap' ).show();\n\t\t\t\t\t\t$body.trigger( 'edd_discount_invalid', [ discount_response ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( window.console && window.console.log ) {\n\t\t\t\t\t\tconsole.log( discount_response );\n\t\t\t\t\t}\n\t\t\t\t\t$body.trigger( 'edd_discount_failed', [ discount_response ] );\n\t\t\t\t}\n\t\t\t\tedd_discount_loader.hide();\n\t\t\t},\n\t\t} ).fail( function( data ) {\n\t\t\tif ( window.console && window.console.log ) {\n\t\t\t\tconsole.log( data );\n\t\t\t}\n\t\t} );\n\n\t\treturn false;\n\t}\n\n\tfunction remove_discount( event ) {\n\t\tconst $this = $( this ),\n\t\t\tpostData = {\n\t\t\t\taction: 'edd_remove_discount',\n\t\t\t\tcode: $this.data( 'code' ),\n\t\t\t};\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\tdata: postData,\n\t\t\tdataType: 'json',\n\t\t\turl: edd_global_vars.ajaxurl,\n\t\t\txhrFields: {\n\t\t\t\twithCredentials: true,\n\t\t\t},\n\t\t\tsuccess: function( discount_response ) {\n\t\t\t\tconst zero = '0' + edd_global_vars.decimal_separator + '00';\n\n\t\t\t\t$( '.edd_cart_amount' ).each( function() {\n\t\t\t\t\tif ( edd_global_vars.currency_sign + zero == $( this ).text() || zero + edd_global_vars.currency_sign == $( this ).text() ) {\n\t\t\t\t\t\t// We're removing a 100% discount code so we need to force the payment gateway to reload\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Format discounted amount for display.\n\t\t\t\t\t$( this ).text( discount_response.total );\n\t\t\t\t\t// Set data attribute to new (unformatted) discounted amount.'\n\t\t\t\t\t$( this ).data( 'total', discount_response.total_plain );\n\t\t\t\t} );\n\n\t\t\t\t$( '.edd_cart_discount' ).html( discount_response.html );\n\n\t\t\t\tif ( discount_response.discounts && 0 === discount_response.discounts.length ) {\n\t\t\t\t\t$( '.edd_cart_discount_row' ).hide();\n\t\t\t\t}\n\n\t\t\t\trecalculateTaxes();\n\n\t\t\t\t$( '#edd_cc_fields,#edd_cc_address' ).slideDown();\n\n\t\t\t\t$body.trigger( 'edd_discount_removed', [ discount_response ] );\n\t\t\t},\n\t\t} ).fail( function( data ) {\n\t\t\tif ( window.console && window.console.log ) {\n\t\t\t\tconsole.log( data );\n\t\t\t}\n\t\t} );\n\n\t\treturn false;\n\t}\n\n\tfunction update_item_quantities( event ) {\n\t\tconst $this = $( this ),\n\t\t\tquantity = $this.val(),\n\t\t\tkey = $this.data( 'key' ),\n\t\t\tdownload_id = $this.closest( '.edd_cart_item' ).data( 'download-id' ),\n\t\t\toptions = $this.parent().find( 'input[name=\"edd-cart-download-' + key + '-options\"]' ).val();\n\n\t\tconst edd_cc_address = $( '#edd_cc_address' );\n\t\tconst billing_country = edd_cc_address.find( '#billing_country' ).val(),\n\t\t\tcard_state = edd_cc_address.find( '#card_state' ).val();\n\n\t\tconst postData = {\n\t\t\taction: 'edd_update_quantity',\n\t\t\tquantity: quantity,\n\t\t\tdownload_id: download_id,\n\t\t\toptions: options,\n\t\t\tbilling_country: billing_country,\n\t\t\tcard_state: card_state,\n\t\t};\n\n\t\t//edd_discount_loader.show();\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\tdata: postData,\n\t\t\tdataType: 'json',\n\t\t\turl: edd_global_vars.ajaxurl,\n\t\t\txhrFields: {\n\t\t\t\twithCredentials: true,\n\t\t\t},\n\t\t\tsuccess: function( response ) {\n\t\t\t\t$( '.edd_cart_subtotal_amount' ).each( function() {\n\t\t\t\t\t$( this ).text( response.subtotal );\n\t\t\t\t} );\n\n\t\t\t\t$( '.edd_cart_tax_amount' ).each( function() {\n\t\t\t\t\t$( this ).text( response.taxes );\n\t\t\t\t} );\n\n\t\t\t\t$( '.edd_cart_amount' ).each( function() {\n\t\t\t\t\t$( this ).text( response.total );\n\t\t\t\t\t$body.trigger( 'edd_quantity_updated', [ response ] );\n\t\t\t\t} );\n\t\t\t},\n\t\t} ).fail( function( data ) {\n\t\t\tif ( window.console && window.console.log ) {\n\t\t\t\tconsole.log( data );\n\t\t\t}\n\t\t} );\n\n\t\treturn false;\n\t}\n\n\t// Expose some functions or variables to window.EDD_Checkout object\n\treturn {\n\t\tinit: init,\n\t\trecalculate_taxes: recalculateTaxes,\n\t};\n}( window.jQuery ) );\n\n// init on document.ready\nwindow.jQuery( document ).ready( EDD_Checkout.init );\n","/* global edd_global_vars */\n\n/**\n * Generate markup for a credit card icon based on a passed type.\n *\n * @param {string} type Credit card type.\n * @return HTML markup.\n */\nexport const getCreditCardIcon = ( type ) => {\n\tlet width;\n\tlet name = type;\n\n\tswitch ( type ) {\n\t\tcase 'amex':\n\t\t\tname = 'americanexpress';\n\t\t\twidth = 32;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\twidth = 50;\n\t\t\tbreak;\n\t}\n\n\treturn `\n    <svg\n      width=${ width }\n      height=${ 32 }\n      class=\"payment-icon icon-${ name }\"\n      role=\"img\"\n    >\n      <use\n        href=\"#icon-${ name }\"\n        xlink:href=\"#icon-${ name }\">\n      </use>\n    </svg>`;\n};\n\nlet ajax_tax_count = 0;\n\n/**\n * Recalulate taxes.\n *\n * @param {string} state State to calculate taxes for.\n * @return {Promise}\n */\nexport function recalculateTaxes( state ) {\n\tif ( '1' != edd_global_vars.taxes_enabled ) {\n\t\treturn;\n\t} // Taxes not enabled\n\n\tconst $edd_cc_address = jQuery( '#edd_cc_address' );\n\n\tconst billing_country = $edd_cc_address.find( '#billing_country' ).val(),\n\t\tcard_address = $edd_cc_address.find( '#card_address' ).val(),\n\t\tcard_address_2 = $edd_cc_address.find( '#card_address_2' ).val(),\n\t\tcard_city = $edd_cc_address.find( '#card_city' ).val(),\n\t\tcard_state = $edd_cc_address.find( '#card_state' ).val(),\n\t\tcard_zip = $edd_cc_address.find( '#card_zip' ).val();\n\n\tif ( ! state ) {\n\t\tstate = card_state;\n\t}\n\n\tconst postData = {\n\t\taction: 'edd_recalculate_taxes',\n\t\tcard_address: card_address,\n\t\tcard_address_2: card_address_2,\n\t\tcard_city: card_city,\n\t\tcard_zip: card_zip,\n\t\tstate: state,\n\t\tbilling_country: billing_country,\n\t\tnonce: jQuery( '#edd-checkout-address-fields-nonce' ).val(),\n\t};\n\n\tjQuery( '#edd_purchase_submit [type=submit]' ).after( '<span class=\"edd-loading-ajax edd-recalculate-taxes-loading edd-loading\"></span>' );\n\n\tconst current_ajax_count = ++ajax_tax_count;\n\n\treturn jQuery.ajax( {\n\t\ttype: 'POST',\n\t\tdata: postData,\n\t\tdataType: 'json',\n\t\turl: edd_global_vars.ajaxurl,\n\t\txhrFields: {\n\t\t\twithCredentials: true,\n\t\t},\n\t\tsuccess: function( tax_response ) {\n\t\t\t// Only update tax info if this response is the most recent ajax call.\n\t\t\t// Avoids bug with form autocomplete firing multiple ajax calls at the same time and not\n\t\t\t// being able to predict the call response order.\n\t\t\tif ( current_ajax_count === ajax_tax_count ) {\n\t\t\t\tjQuery( '#edd_checkout_cart_form' ).replaceWith( tax_response.html );\n\t\t\t\tjQuery( '.edd_cart_amount' ).html( tax_response.total );\n\t\t\t\tconst tax_data = new Object();\n\t\t\t\ttax_data.postdata = postData;\n\t\t\t\ttax_data.response = tax_response;\n\t\t\t\tjQuery( 'body' ).trigger( 'edd_taxes_recalculated', [ tax_data ] );\n\t\t\t}\n\t\t\tjQuery( '.edd-recalculate-taxes-loading' ).remove();\n\t\t},\n\t} ).fail( function( data ) {\n\t\tif ( window.console && window.console.log ) {\n\t\t\tconsole.log( data );\n\t\t\tif ( current_ajax_count === ajax_tax_count ) {\n\t\t\t\tjQuery( 'body' ).trigger( 'edd_taxes_recalculated', [ tax_data ] );\n\t\t\t}\n\t\t}\n\t} );\n}\n"],"sourceRoot":""}