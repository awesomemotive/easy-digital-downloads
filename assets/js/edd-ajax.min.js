function edd_load_gateway(e){jQuery(".edd-cart-ajax").show();jQuery("#edd_purchase_form_wrap").html('<img src="'+edd_scripts.ajax_loader+'"/>');jQuery.post(edd_scripts.ajaxurl+"?payment-mode="+e,{action:"edd_load_gateway",edd_payment_mode:e},function(e){jQuery("#edd_purchase_form_wrap").html(e);jQuery(".edd-no-js").hide()})}var edd_scripts;jQuery(document).ready(function(e){e(".edd-no-js").hide();e("a.edd-add-to-cart").addClass("edd-has-js");e("body").on("click.eddRemoveFromCart",".edd-remove-from-cart",function(t){var n=e(this),r=n.data("cart-item"),i=n.data("action"),s=n.data("download-id"),o={action:i,cart_item:r};e.ajax({type:"POST",data:o,dataType:"json",url:edd_scripts.ajaxurl,success:function(t){if(t.removed){if(parseInt(edd_scripts.position_in_cart,10)===parseInt(r,10)){window.location=window.location;return false}e(".edd-cart").find("[data-cart-item='"+r+"']").parent().remove();if(e("#edd_purchase_"+s).length){e("#edd_purchase_"+s+" .edd_go_to_checkout").hide();e("#edd_purchase_"+s+" a.edd-add-to-cart").show().removeAttr("data-edd-loading")}e("span.edd-cart-quantity").each(function(){var t=parseInt(e(this).text(),10)-1;if(t<1){t=0}e(this).text(t);e("body").trigger("edd_quantity_updated",[t])});e(".cart_item.edd_subtotal span").html(t.subtotal);if(!e(".edd-cart-item").length){e(".cart_item.edd_subtotal,.edd-cart-number-of-items,.cart_item.edd_checkout").hide();e(".edd-cart").append('<li class="cart_item empty">'+edd_scripts.empty_cart_message+"</li>")}e("body").trigger("edd_cart_item_removed",[t])}}}).fail(function(e){if(window.console&&window.console.log){console.log(e)}}).done(function(e){});return false});e("body").on("click.eddAddToCart",".edd-add-to-cart",function(t){t.preventDefault();var n=e(this),r=n.closest("form");if("straight_to_gateway"==r.find(".edd_action_input").val()){r.submit();return true}var i=n.find(".edd-loading");var s=n.closest("div");var o=i.width(),u=i.height();n.attr("data-edd-loading","");i.css({"margin-left":o/-2,"margin-top":u/-2});var r=n.parents("form").last();var a=n.data("download-id");var f=n.data("variable-price");var l=n.data("price-mode");var c=[];if(f=="yes"){if(!e(".edd_price_option_"+a+":checked",r).length){n.removeAttr("data-edd-loading");alert(edd_scripts.select_option);return}e(".edd_price_option_"+a+":checked",r).each(function(t){c[t]=e(this).val()})}else{c[0]=a}var h=n.data("action");var p={action:h,download_id:a,price_ids:c,post_data:e(r).serialize()};e.ajax({type:"POST",data:p,dataType:"json",url:edd_scripts.ajaxurl,success:function(t){if(edd_scripts.redirect_to_checkout=="1"){window.location=edd_scripts.checkout_page}else{if(e(".cart_item.empty").length){e(t.cart_item).insertBefore(".cart_item.edd_subtotal");e(".cart_item.edd_checkout,.cart_item.edd_subtotal").show();e(".cart_item.empty").remove()}else{e(t.cart_item).insertBefore(".cart_item.edd_subtotal")}e(".cart_item.edd_subtotal span").html(t.subtotal);e("span.edd-cart-quantity").each(function(){var t=parseInt(e(this).text(),10)+1;e(this).text(t);e("body").trigger("edd_quantity_updated",[t])});if(e(".edd-cart-number-of-items").css("display")=="none"){e(".edd-cart-number-of-items").show("slow")}if(f=="no"||l!="multi"){e("a.edd-add-to-cart",s).toggle();e(".edd_go_to_checkout",s).css("display","inline-block")}if(l=="multi"){n.removeAttr("data-edd-loading")}if(e(".edd_download_purchase_form").length){var r=e('.edd_download_purchase_form *[data-download-id="'+a+'"]').parents("form");e("a.edd-add-to-cart",r).hide();e(".edd_go_to_checkout",r).show().removeAttr("data-edd-loading")}if(t!="incart"){e(".edd-cart-added-alert",s).fadeIn();setTimeout(function(){e(".edd-cart-added-alert",s).fadeOut()},3e3)}e("body").trigger("edd_cart_item_added",[t])}}}).fail(function(e){if(window.console&&window.console.log){console.log(e)}}).done(function(e){});return false});e("#edd_checkout_form_wrap").on("click",".edd_checkout_register_login",function(){var t=e(this),n={action:t.data("action")};e(".edd-cart-ajax").show();e.post(edd_scripts.ajaxurl,n,function(t){e("#edd_checkout_login_register").html(edd_scripts.loading);e("#edd_checkout_login_register").html(t);e(".edd-cart-ajax").hide()});return false});e(document).on("click","#edd_purchase_form #edd_login_fields input[type=submit]",function(t){t.preventDefault();var n=e(this).val();e(this).val(edd_global_vars.purchase_loading);e(this).after('<span class="edd-cart-ajax"><i class="edd-icon-spinner edd-icon-spin"></i></span>');var r={action:"edd_process_checkout_login",edd_ajax:1,edd_user_login:e("#edd_login_fields #edd_user_login").val(),edd_user_pass:e("#edd_login_fields #edd_user_pass").val()};e.post(edd_global_vars.ajaxurl,r,function(t){if(e.trim(t)=="success"){e(".edd_errors").remove();window.location=edd_scripts.checkout_page}else{e("#edd_login_fields input[type=submit]").val(n);e(".edd-cart-ajax").remove();e(".edd_errors").remove();e("#edd-user-login-submit").before(t)}})});e("select#edd-gateway, input.edd-gateway").change(function(t){var n=e("#edd-gateway option:selected, input.edd-gateway:checked").val();if(n=="0")return false;edd_load_gateway(n);return false});if(edd_scripts.is_checkout=="1"&&e("select#edd-gateway, input.edd-gateway").length){setTimeout(function(){edd_load_gateway(edd_scripts.default_gateway)},200)}e(document).on("click","#edd_purchase_form #edd_purchase_submit input[type=submit]",function(t){t.preventDefault();var n=e(this).val();e(this).val(edd_global_vars.purchase_loading);e(this).after('<span class="edd-cart-ajax"><i class="edd-icon-spinner edd-icon-spin"></i></span>');e.post(edd_global_vars.ajaxurl,e("#edd_purchase_form").serialize()+"&action=edd_process_checkout&edd_ajax=true",function(t){if(e.trim(t)=="success"){e(".edd_errors").remove();e("#edd_purchase_form").submit()}else{e("#edd_purchase_form input[type=submit]").val(n);e(".edd-cart-ajax").remove();e(".edd_errors").remove();e("#edd_purchase_submit").before(t)}})})})