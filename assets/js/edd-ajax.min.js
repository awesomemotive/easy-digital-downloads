function edd_load_gateway(e){jQuery(".edd-cart-ajax").show();jQuery("#edd_purchase_form_wrap").html('<img src="'+edd_scripts.ajax_loader+'"/>');jQuery.post(edd_scripts.ajaxurl+"?payment-mode="+e,{action:"edd_load_gateway",edd_payment_mode:e},function(e){jQuery("#edd_purchase_form_wrap").html(e)})}var edd_scripts;jQuery(document).ready(function(e){e(".edd-no-js").hide();e("a.edd-add-to-cart").addClass("edd-has-js");e("body").on("click.eddRemoveFromCart",".edd-remove-from-cart",function(t){var n=e(this),r=n.data("cart-item"),i=n.data("action"),s=n.data("download-id"),o={action:i,cart_item:r,nonce:edd_scripts.ajax_nonce};e.post(edd_scripts.ajaxurl,o,function(t){if(t=="removed"){if(parseInt(edd_scripts.position_in_cart,10)===parseInt(r,10)){window.location=window.location;return false}n.parent().remove();if(e("#edd_purchase_"+s).length){e("#edd_purchase_"+s+" .edd_go_to_checkout").hide();e("#edd_purchase_"+s+" a.edd-add-to-cart").show()}e("span.edd-cart-quantity").each(function(){var t=parseInt(e(this).text(),10)-1;e(this).text(t)});o={action:"edd_get_subtotal",nonce:edd_scripts.ajax_nonce};e.post(edd_scripts.ajaxurl,o,function(t){e(".cart_item.edd_subtotal span").html(t)});if(!e(".edd-cart-item").length){e(".cart_item.edd_subtotal").hide();e(".edd-cart-number-of-items").hide();e(".cart_item.edd_checkout").hide();e(".edd-cart").append('<li class="cart_item empty">'+edd_scripts.empty_cart_message+"</li>")}else{}}});return false});e("body").on("click.eddAddToCart",".edd-add-to-cart",function(t){t.preventDefault();var n=e(this),r=n.closest("form");if("straight_to_gateway"==r.find(".edd_action_input").val()){r.submit();return true}var i=n.find(".edd-loading");var s=n.closest("div");var o=i.width();spinnerHeight=i.height();n.attr("data-edd-loading","");i.css({"margin-left":o/-2,"margin-top":spinnerHeight/-2});console.log(spinnerHeight);var r=n.parents("form").last();var u=n.data("download-id");var a=n.data("variable-price");var f=n.data("price-mode");var l=[];if(a=="yes"){if(!e(".edd_price_option_"+u+":checked",r).length){n.removeAttr("data-edd-loading");alert(edd_scripts.select_option);return}e(".edd_price_option_"+u+":checked",r).each(function(t){l[t]=e(this).val()})}else{l[0]=u}var c=n.data("action"),h={action:c,download_id:u,price_ids:l,nonce:edd_scripts.ajax_nonce,post_data:e(r).serialize()};e.post(edd_scripts.ajaxurl,h,function(t){if(edd_scripts.redirect_to_checkout=="1"){window.location=edd_scripts.checkout_page}else{if(e(".cart_item.empty").length){e(t).insertBefore(".cart_item.edd_subtotal");e(".cart_item.edd_checkout").show();e(".cart_item.edd_subtotal").show();e(".cart_item.empty").remove()}else{e(t).insertBefore(".cart_item.edd_subtotal")}e(".cart_item.edd_subtotal span").html(e(".temp-subtotal").text());e(".temp-subtotal").remove();e("span.edd-cart-quantity").each(function(){var t=parseInt(e(this).text(),10)+1;e(this).text(t)});if(e(".edd-cart-number-of-items").css("display")=="none"){e(".edd-cart-number-of-items").show("slow")}if(a=="no"||f!="multi"){e("a.edd-add-to-cart",s).toggle();e(".edd_go_to_checkout",s).css("display","inline-block")}if(f=="multi"){n.removeAttr("data-edd-loading")}if(t!="incart"){e(".edd-cart-added-alert",s).fadeIn();setTimeout(function(){e(".edd-cart-added-alert",s).fadeOut()},3e3)}}});return false});e("#edd_checkout_form_wrap").on("click",".edd_checkout_register_login",function(){var t=e(this),n=t.data("action"),r={action:n,nonce:edd_scripts.ajax_nonce};e(".edd-cart-ajax").show();e.post(edd_scripts.ajaxurl,r,function(t){e("#edd_checkout_login_register").html(edd_scripts.loading);e("#edd_checkout_login_register").html(t);e(".edd-cart-ajax").hide()});return false});e("select#edd-gateway, input.edd-gateway").change(function(t){var n=e("#edd-gateway option:selected, input.edd-gateway:checked").val();if(n=="0")return false;edd_load_gateway(n);return false});if(edd_scripts.is_checkout=="1"&&e("select#edd-gateway, input.edd-gateway").length){setTimeout(function(){edd_load_gateway(edd_scripts.default_gateway)},200)}e(document).on("click","#edd_purchase_form input[type=submit]",function(t){t.preventDefault();var n=e(this).val();e(this).val(edd_global_vars.purchase_loading);e(this).after('<img src="'+edd_scripts.ajax_loader+'" class="edd-cart-ajax" />');e.post(edd_global_vars.ajaxurl,e("#edd_purchase_form").serialize()+"&action=edd_process_checkout&edd_ajax=true",function(t){if(e.trim(t)=="success"){e(".edd_errors").remove();e("#edd_purchase_form").submit()}else{e("#edd_purchase_form input[type=submit]").val(n);e(".edd-cart-ajax").remove();e(".edd_errors").remove();e("#edd_purchase_submit").before(t)}})})})