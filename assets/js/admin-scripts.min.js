jQuery(document).ready(function(f){var i={init:function(){this.add();this.move();this.remove();this.type();this.prices();this.files();this.updatePrices()},clone_repeatable:function(l){var k=highest=1;l.parent().find("tr.edd_repeatable_row").each(function(){var m=f(this).data("key");if(parseInt(m)>highest){highest=m}});k=highest+=1;clone=l.clone();clone.find("select").each(function(){f(this).val(l.find('select[name="'+f(this).attr("name")+'"]').val())});clone.removeClass("edd_add_blank");clone.data("key",k);clone.find("td input, td select").val("");clone.find("input, select").each(function(){var m=f(this).attr("name");m=m.replace(/\[(\d+)\]/,"["+parseInt(k)+"]");f(this).attr("name",m).attr("id",m)});clone.find("span.edd_price_id").each(function(){f(this).text(parseInt(k))});clone.find(".edd_repeatable_default_input").each(function(){f(this).val(parseInt(count)).removeAttr("checked")});return clone},add:function(){f("body").on("click",".submit .edd_add_repeatable",function(l){l.preventDefault();var k=f(this),m=k.parent().parent().prev("tr"),n=i.clone_repeatable(m);n.insertAfter(m)})},move:function(){f(".edd_repeatable_table tbody").sortable({handle:".edd_draghandle",items:".edd_repeatable_row",opacity:0.6,cursor:"move",axis:"y",update:function(){var k=0;f(this).find("tr").each(function(){f(this).find("input.edd_repeatable_index").each(function(){f(this).val(k)});k++})}})},remove:function(){f("body").on("click",".edd_remove_repeatable",function(n){n.preventDefault();var o=f(this).parent().parent("tr"),m=o.parent().find("tr").length-1,l=f(this).data("type"),k="tr.edd_repeatable_"+l+"s";f(".edd_repeatable_condition_field option[value="+o.index()+"]").remove();if(m>1){f("input, select",o).val("");o.fadeOut("fast").remove()}else{switch(l){case"price":alert(edd_vars.one_price_min);break;case"file":alert(edd_vars.one_file_min);break;default:alert(edd_vars.one_field_min);break}}f(k).each(function(p){f(this).find("input, select").each(function(){var q=f(this).attr("name");q=q.replace(/\[(\d+)\]/,"["+p+"]");f(this).attr("name",q).attr("id",q)})})})},type:function(){f("body").on("change","#_edd_product_type",function(k){if("bundle"===f(this).val()){f("#edd_products").show();f("#edd_download_files").hide();f("#edd_download_limit_wrap").hide()}else{f("#edd_products").hide();f("#edd_download_files").show();f("#edd_download_limit_wrap").show()}})},prices:function(){f("body").on("change","#edd_variable_pricing",function(k){f(".edd_pricing_fields,.edd_repeatable_table .pricing").toggle()})},files:function(){if(typeof wp==="undefined"||"1"!==edd_vars.new_media_ui){if(f(".edd_upload_file_button").length>0){window.formfield="";f("body").on("click",".edd_upload_file_button",function(m){m.preventDefault();window.formfield=f(this).parent().prev();window.tbframe_interval=setInterval(function(){jQuery("#TB_iframeContent").contents().find(".savesend .button").val(edd_vars.use_this_file).end().find("#insert-gallery, .wp-post-thumbnail").hide()},2000);if(edd_vars.post_id!=null){var l="post_id="+edd_vars.post_id+"&"}tb_show(edd_vars.add_new_download,"media-upload.php?"+l+"TB_iframe=true")});window.edd_send_to_editor=window.send_to_editor;window.send_to_editor=function(l){if(window.formfield){imgurl=f("a","<div>"+l+"</div>").attr("href");window.formfield.val(imgurl);window.clearInterval(window.tbframe_interval);tb_remove()}else{window.edd_send_to_editor(l)}window.send_to_editor=window.edd_send_to_editor;window.formfield="";window.imagefield=false}}}else{var k;window.formfield="";f("body").on("click",".edd_upload_file_button",function(m){m.preventDefault();var l=f(this);window.formfield=f(this).closest(".edd_repeatable_upload_wrapper");if(k){k.open();return}k=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:l.data("uploader-title"),button:{text:l.data("uploader-button-text")},multiple:f(this).data("multiple")=="0"?false:true});k.on("menu:render:default",function(o){var n={};o.unset("library-separator");o.unset("gallery");o.unset("featured-image");o.unset("embed");o.set(n)});k.on("insert",function(){var n=k.state().get("selection");n.each(function(q,o){q=q.toJSON();if(0===o){window.formfield.find(".edd_repeatable_attachment_id_field").val(q.id);window.formfield.find(".edd_repeatable_upload_field").val(q.url);window.formfield.find(".edd_repeatable_name_field").val(q.title)}else{var p=window.formfield,r=i.clone_repeatable(p);r.find(".edd_repeatable_attachment_id_field").val(q.id);r.find(".edd_repeatable_upload_field").val(q.url);if(q.title.length>0){r.find(".edd_repeatable_name_field").val(q.title)}else{r.find(".edd_repeatable_name_field").val(q.filename)}r.insertAfter(p)}})});k.open()});var k;window.formfield=""}},updatePrices:function(){f("#edd_price_fields").on("keyup",".edd_variable_prices_name",function(){var m=f(this).parents("tr").index(),l=f(this).val(),k=f(".edd_repeatable_condition_field option[value="+m+"]");if(k.length>0){k.text(l)}else{f(".edd_repeatable_condition_field").append(f("<option></option>").attr("value",m).text(l))}})}};i.init();if(f(".edd_datepicker").length>0){var a="mm/dd/yy";f(".edd_datepicker").datepicker({dateFormat:a})}var c={init:function(){this.edit_address();this.remove_download();this.add_download();this.recalculate_total();this.variable_prices_check();this.add_note();this.remove_note();this.resend_receipt();this.copy_download_link()},edit_address:function(){f('select[name="edd-payment-address[0][country]"]').change(function(){var k=f(this);data={action:"edd_get_shop_states",country:k.val(),field_name:"edd-payment-address[0][state]"};f.post(ajaxurl,data,function(l){if("nostates"==l){f("#edd-order-address-state-wrap select, #edd-order-address-state-wrap input").replaceWith('<input type="text" name="edd-payment-address[0][state]" value="" class="edd-edit-toggles medium-text"/>')}else{f("#edd-order-address-state-wrap select, #edd-order-address-state-wrap input").replaceWith(l)}});return false})},remove_download:function(){f("#edd-purchased-files").on("click",".edd-order-remove-download",function(){if(confirm(edd_vars.delete_payment_download)){f(this).parent().parent().parent().remove();f("#edd-payment-downloads-changed").val(1);f(".edd-order-payment-recalc-totals").show()}return false})},add_download:function(){f("#edd-purchased-files").on("click","#edd-order-add-download",function(p){p.preventDefault();var l=f("#edd_order_download_select").val();var t=f(".select2-chosen").text();var n=f("#edd-order-download-amount").val();var r=f(".edd_price_options_select option:selected").val();var k=f(".edd_price_options_select option:selected").text();var m=f("#edd-order-download-quantity").val();if(l<1){return false}if(!n){n="0.00"}var s=n+edd_vars.currency_sign;if("before"===edd_vars.currency_pos){s=edd_vars.currency_sign+n}if(k){t=t+" - "+k}var o=f("#edd-purchased-files div.row").length;var q=f("#edd-purchased-files div.row:last").clone();q.find(".download span").html('<a href="post.php?post='+l+'&action=edit"></a>');q.find(".download span a").text(t);q.find(".price").text(s);q.find(".quantity span").text(m);q.find("input.edd-payment-details-download-id").val(l);q.find("input.edd-payment-details-download-price-id").val(r);q.find("input.edd-payment-details-download-amount").val(n);q.find("input.edd-payment-details-download-quantity").val(m);q.find("input").each(function(){var u=f(this).attr("name");u=u.replace(/\[(\d+)\]/,"["+parseInt(o)+"]");f(this).attr("name",u).attr("id",u)});f("#edd-payment-downloads-changed").val(1);f(q).insertAfter("#edd-purchased-files div.row:last");f(".edd-order-payment-recalc-totals").show()})},recalculate_total:function(){f("#edd-order-recalc-total").on("click",function(l){l.preventDefault();var k=0;if(f("#edd-purchased-files .row .edd-payment-details-download-amount").length){f("#edd-purchased-files .row .edd-payment-details-download-amount").each(function(){var m=f(this).next().val();if(m){k+=(parseFloat(f(this).val())*parseInt(m))}else{k+=parseFloat(f(this).val())}})}if(f(".edd-payment-fees").length){f(".edd-payment-fees span.fee-amount").each(function(){k+=parseFloat(f(this).data("fee"))})}f("input[name=edd-payment-total]").val(k)})},variable_prices_check:function(){f("#edd-purchased-files").on("change","select#edd_order_download_select",function(){var m=f(this),l=m.val();if(parseInt(l)>0){var k={action:"edd_check_for_download_price_variations",download_id:l};f.ajax({type:"POST",data:k,url:ajaxurl,success:function(n){f(".edd_price_options_select").remove();f(n).insertAfter(m.next())}}).fail(function(n){if(window.console&&window.console.log){console.log(n)}})}})},add_note:function(){f("#edd-add-payment-note").on("click",function(m){m.preventDefault();var l={action:"edd_insert_payment_note",payment_id:f(this).data("payment-id"),note:f("#edd-payment-note").val()};if(l.note){f.ajax({type:"POST",data:l,url:ajaxurl,success:function(n){f("#edd-payment-notes-inner").append(n);f(".edd-no-payment-notes").hide();f("#edd-payment-note").val("")}}).fail(function(n){if(window.console&&window.console.log){console.log(n)}})}else{var k=f("#edd-payment-note").css("border-color");f("#edd-payment-note").css("border-color","red");setTimeout(function(){f("#edd-payment-note").css("border-color",k)},500)}})},remove_note:function(){f("body").on("click",".edd-delete-payment-note",function(l){l.preventDefault();if(confirm(edd_vars.delete_payment_note)){var k={action:"edd_delete_payment_note",payment_id:f(this).data("payment-id"),note_id:f(this).data("note-id")};f.ajax({type:"POST",data:k,url:ajaxurl,success:function(m){f("#edd-payment-note-"+k.note_id).remove();if(!f(".edd-payment-note").length){f(".edd-no-payment-notes").show()}return false}}).fail(function(m){if(window.console&&window.console.log){console.log(m)}});return true}})},resend_receipt:function(){f("body").on("click","#edd-resend-receipt",function(k){return confirm(edd_vars.resend_receipt)})},copy_download_link:function(){f("body").on("click",".edd-copy-download-link",function(m){m.preventDefault();var l=f(this);var k={action:"edd_get_file_download_link",payment_id:f('input[name="edd_payment_id"]').val(),download_id:l.data("download-id"),price_id:l.data("price-id")};f.ajax({type:"POST",data:k,url:ajaxurl,success:function(n){f("#edd-download-link").dialog({width:400}).html('<textarea rows="10" cols="40" id="edd-download-link-textarea">'+n+"</textarea>");f("#edd-download-link-textarea").focus().select();return false}}).fail(function(n){if(window.console&&window.console.log){console.log(n)}})})}};c.init();var j={init:function(){this.type_select();this.product_requirements()},type_select:function(){f("#edd-edit-discount #edd-type, #edd-add-discount #edd-type").change(function(){f(".edd-amount-description").toggle()})},product_requirements:function(){f("#products").change(function(){if(f(this).val()){f("#edd-discount-product-conditions").show()}else{f("#edd-discount-product-conditions").hide()}})},};j.init();var g={init:function(){this.date_options();this.customers_export()},date_options:function(){f("#edd-graphs-date-options").change(function(){var k=f(this);if("other"===k.val()){f("#edd-date-range-options").show()}else{f("#edd-date-range-options").hide()}})},customers_export:function(){f("#edd_customer_export_download").change(function(){var m=f(this),k=f("option:selected",m).val();if("0"===m.val()){f("#edd_customer_export_option").show()}else{f("#edd_customer_export_option").hide()}if(parseInt(k)!=0){var l={action:"edd_check_for_download_price_variations",download_id:k};f.post(ajaxurl,l,function(n){f(".edd_price_options_select").remove();m.after(n)})}else{f(".edd_price_options_select").remove()}})}};g.init();var e={init:function(){this.general();this.taxes();this.emails();this.misc()},general:function(){if(f(".edd-color-picker").length){f(".edd-color-picker").wpColorPicker()}if(typeof wp==="undefined"||"1"!==edd_vars.new_media_ui){if(f(".edd_settings_upload_button").length>0){window.formfield="";f("body").on("click",".edd_settings_upload_button",function(l){l.preventDefault();window.formfield=f(this).parent().prev();window.tbframe_interval=setInterval(function(){jQuery("#TB_iframeContent").contents().find(".savesend .button").val(edd_vars.use_this_file).end().find("#insert-gallery, .wp-post-thumbnail").hide()},2000);tb_show(edd_vars.add_new_download,"media-upload.php?TB_iframe=true")});window.edd_send_to_editor=window.send_to_editor;window.send_to_editor=function(l){if(window.formfield){imgurl=f("a","<div>"+l+"</div>").attr("href");window.formfield.val(imgurl);window.clearInterval(window.tbframe_interval);tb_remove()}else{window.edd_send_to_editor(l)}window.send_to_editor=window.edd_send_to_editor;window.formfield="";window.imagefield=false}}}else{var k;window.formfield="";f("body").on("click",".edd_settings_upload_button",function(m){m.preventDefault();var l=f(this);window.formfield=f(this).parent().prev();if(k){k.open();return}k=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:l.data("uploader_title"),button:{text:l.data("uploader_button_text")},multiple:false});k.on("menu:render:default",function(o){var n={};o.unset("library-separator");o.unset("gallery");o.unset("featured-image");o.unset("embed");o.set(n)});k.on("insert",function(){var n=k.state().get("selection");n.each(function(p,o){p=p.toJSON();window.formfield.val(p.url)})});k.open()});var k;window.formfield=""}},taxes:function(){if(f("select.edd-no-states").length){f("select.edd-no-states").closest("tr").hide()}f('select[name="edd_settings[base_country]"]').change(function(){var l=f(this),k=l.closest("tr");data={action:"edd_get_shop_states",country:f(this).val(),field_name:"edd_settings[base_state]"};f.post(ajaxurl,data,function(m){if("nostates"==m){k.next().hide()}else{k.next().show();k.next().find("select").replaceWith(m)}});return false});f("body").on("change","#edd_tax_rates select.edd-tax-country",function(){var k=f(this);data={action:"edd_get_shop_states",country:f(this).val(),field_name:k.attr("name").replace("country","state")};f.post(ajaxurl,data,function(l){if("nostates"==l){var m='<input type="text" name="'+data.field_name+'" value=""/>';k.parent().next().find("select").replaceWith(m)}else{k.parent().next().find("input,select").show();k.parent().next().find("input,select").replaceWith(l)}});return false});f("#edd_add_tax_rate").on("click",function(){var l=f("#edd_tax_rates tr:last");var m=l.clone();var k=l.parent().find("tr").length;m.find("td input").val("");m.find("input, select").each(function(){var n=f(this).attr("name");n=n.replace(/\[(\d+)\]/,"["+parseInt(k)+"]");f(this).attr("name",n).attr("id",n)});m.insertAfter(l);return false});f("body").on("click","#edd_tax_rates .edd_remove_tax_rate",function(){if(confirm(edd_vars.delete_tax_rate)){f(this).closest("tr").remove()}return false})},emails:function(){if(f("#email-preview-wrap").length){var k=f("#email-preview");f("#open-email-preview").colorbox({inline:true,href:k,width:"80%",height:"auto"})}},misc:function(){if(f('select[name="edd_settings[download_method]"]:selected').val()!="direct"){f('select[name="edd_settings[download_method]"]').parent().parent().next().hide();f('select[name="edd_settings[download_method]"]').parent().parent().next().find("input").attr("checked",false)}f('select[name="edd_settings[download_method]"]').on("change",function(){var k=f(this).parent().parent().next();if(f(this).val()=="direct"){k.hide()}else{k.show();k.find("input").attr("checked",false)}})}};e.init();f(".download_page_edd-payment-history .row-actions .delete a").on("click",function(){if(confirm(edd_vars.delete_payment)){return true}return false});f("#the-list").on("click",".editinline",function(){inlineEditPost.revert();var l=f(this).closest("tr").attr("id");l=l.replace("post-","");var k=f("#post-"+l);var m=k.find(".column-price .downloadprice-"+l).val();if(m!=f("#post-"+l+".column-price .downloadprice-"+l).val()){f(".regprice","#edd-download-data").val(m).attr("disabled",false)}else{f(".regprice","#edd-download-data").val(edd_vars.quick_edit_warning).attr("disabled","disabled")}});f("body").on("click","#bulk_edit",function(){var l=f("#bulk-edit");var k=new Array();l.find("#bulk-titles").children().each(function(){k.push(f(this).attr("id").replace(/^(ttle)/i,""))});var m=f('#edd-download-data input[name="_edd_regprice"]').val();var n={action:"edd_save_bulk_edit",edd_bulk_nonce:k,post_ids:k,price:m};f.post(ajaxurl,n)});if(f(".edd-select2").attr("multiple")){f(".edd-select2").select2({dropdownAutoWidth:true,})}else{f(".edd-select2").select2({dropdownAutoWidth:true,})}var b;var d=342;var h={init:function(){this.revoke_api_key();this.regenerate_api_key()},revoke_api_key:function(){f("body").on("click",".edd-revoke-api-key",function(k){return confirm(edd_vars.revoke_api_key)})},regenerate_api_key:function(){f("body").on("click",".edd-regenerate-api-key",function(k){return confirm(edd_vars.regenerate_api_key)})},};h.init();f(".edd-ajax-user-search").keyup(function(){var k=f(this).val();f(".edd-ajax").show();data={action:"edd_search_users",user_name:k};document.body.style.cursor="wait";f.ajax({type:"POST",data:data,dataType:"json",url:ajaxurl,success:function(l){f(".edd-ajax").hide();f(".edd_user_search_results").html("");f(l.results).appendTo(".edd_user_search_results");document.body.style.cursor="default"}})});f("body").on("click.eddSelectUser",".edd_user_search_results a",function(l){l.preventDefault();var k=f(this).data("login");f(".edd-ajax-user-search").val(k);f(".edd_user_search_results").html("")})});