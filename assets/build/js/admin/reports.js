(()=>{"use strict";var e={1669:e=>{e.exports=jQuery},6595:(e,t,a)=>{const o=a(9431),n=class{constructor(e={}){const{currency_decimals:t,decimal_separator:a,thousands_separator:o}=edd_vars;this.config={precision:t,decimalSeparator:a,thousandSeparator:o,...e}}format(e){let t=e;"number"!=typeof e&&(t=parseFloat(e)),isNaN(t)&&(t=0);const{precision:a,decimalSeparator:n,thousandSeparator:s}=this.config;return o(t,a,n,s)}unformat(e){const{decimalSeparator:t,thousandSeparator:a}=this.config;"string"!=typeof e&&(e=String(e));const o=e.replace(a,"").replace(t,"."),n=parseFloat(o);return isNaN(n)?0:n}absint(e){const t=this.unformat(e);return t>=0?t:-1*t}},s=class{constructor(e={}){const{currency:t,currency_sign:a,currency_pos:o,currency_decimals:s,decimal_separator:r,thousands_separator:i}=edd_vars;this.config={currency:t,currencySymbol:a,currencySymbolPosition:o,precision:s,decimalSeparator:r,thousandSeparator:i,...e},this.number=new n(this.config)}format(e,t=!0){const{currencySymbol:a,currencySymbolPosition:o}=this.config,n=e<0;let s=this.number.format(e),r="";switch(n&&(s=this.number.format(-1*e)),o){case"before":r=a+s;break;case"after":r=s+a}return!0===n&&!1===t&&(r=`-${r}`),r}unformat(e){const{currencySymbol:t}=this.config,a=e.replace(t,"");return this.number.unformat(a)}},r=(e,t)=>{let a=e;const{type:o}=t;return"currency"===o&&(a=(new s).format(e,!1)),a},i={enabled:!1,intersect:!1,mode:"index",custom:function(e){let t=document.getElementById(this._chart.canvas.parentNode.id+"-tooltip");if(t||(t=document.createElement("div"),t.id=this._chart.canvas.parentNode.id+"-tooltip",t.classList.add("edd-chartjs-tooltip"),t.innerHTML="<table></table>",this._chart.canvas.parentNode.appendChild(t)),0===e.opacity)return void(t.style.opacity=0);const a="pie"===this._chart.config.type||"doughnut"===this._chart.config.type;if(e.body){let o="";e.title.length&&(o+="<thead>"+e.title+"</thead>");const n=e.body.map((function(e){return Array.isArray(e.lines)?e.lines.join("<br>"):e.lines}));o+="<tbody>",n.forEach((function(t,n){const s=e.labelColors[n];var r=s.backgroundColor;a||(r=s.borderColor);const i='<span class="edd-chartjs-tooltip-key" style="'+[`background: ${r}`,`border-color: ${r}`,"border-width: 2px"].join(";")+'"></span>';o+="<tr><td>"+i+t+"</td></tr>"})),o+="</tbody>",t.querySelector("table").innerHTML=o}if(a)t.style.left=e.caretX+"px",t.style.top=e.caretY+"px";else{const a=this._chart.canvas.getBoundingClientRect();let o=t.getBoundingClientRect();const n=this._chart.canvas.offsetLeft+e.caretX;let s=n;s=n>=a.width/2?n-o.width/2-20:n+o.width/2+20,t.style.left=s+"px";const r=this._chart.canvas.offsetTop+Math.round(this._chart.canvas.height/5);t.style.top=r+"px"}t.style.fontFamily=e._bodyFontFamily,t.style.fontSize=e.bodyFontSize+"px",t.style.fontStyle=e._bodyFontStyle,t.style.opacity=1}},d=e=>{const t=new n;return e.callback=function(a,o,n){switch(e.formattingType){case"integer":a=parseInt(a);break;case"format":a=t.format(a)}return a},e},c=e=>{const{target:t}=e,{dates:{utc_offset:a,hour_by_hour:o,day_by_day:n}}=e;e.options.scales.yAxes.forEach((e=>{e.ticks.hasOwnProperty("formattingType")&&(e.ticks=d(e.ticks)),e.ticks.hasOwnProperty("hideNegativeTicks")&&e.ticks.hideNegativeTicks&&(e.afterTickToLabelConversion=function(e){for(let t=e.ticksAsNumbers.length-1;t>=0;t--)e.ticksAsNumbers[t]<0&&(e.ticksAsNumbers.splice(t,1),e.ticks.splice(t,1))})}));const s={...e,options:{...e.options,maintainAspectRatio:!1,tooltips:l(e),scales:{yAxes:[...e.options.scales.yAxes],xAxes:[{...e.options.scales.xAxes[0],ticks:{maxTicksLimit:12,autoSkip:!0,maxRotation:45},time:{...e.options.scales.xAxes[0].time,parser:function(e){return o||n?window.moment(e).utcOffset(a):window.moment.utc(e)}}}]},legend:{onClick:function(e,t){const a=this.chart.config.data.datasets[t.datasetIndex];if(a.hasOwnProperty("yAxisID")){const e=this.chart.options.scales.yAxes.findIndex((e=>e.id===a.yAxisID));-1!==e&&(this.chart.options.scales.yAxes[e].display=!this.chart.options.scales.yAxes[e].display)}a.hidden=!a.hidden,this.chart.update()}}}};let r=document.getElementById(t),i=new Chart(r,s),c=[];for(const[e,t]of Object.entries(i.scales))"time"!==t.type&&c.push(t);if(c.length>1){c.forEach((e=>{e.range=e.max-e.min,e.min_ratio=e.min/e.range,e.max_ratio=e.max/e.range}));let e=c.reduce(((e,t)=>({min_ratio:Math.min(e.min_ratio,t.min_ratio),max_ratio:Math.max(e.max_ratio,t.max_ratio)})));c.forEach((t=>{let a=e.min_ratio*t.range,o=e.max_ratio*t.range,n=i.options.scales.yAxes.find((e=>e.id===t.id));n&&(n.ticks.min=a,n.ticks.max=o)})),i.update()}return i},l=e=>({...i,callbacks:{label:function(t,a){const{options:{datasets:o}}=e,n=o[Object.keys(o)[t.datasetIndex]],s=r(t.yLabel,n);return`${a.datasets[t.datasetIndex].label}: ${s}`}}}),p=e=>({...i,callbacks:{label:function(t,a){const{options:{datasets:o}}=e,n=o[Object.keys(o)[t.datasetIndex]],s=r(t.yLabel,n);return`${a.datasets[t.datasetIndex].label}: ${s}`}}});window.edd=window.edd||{},window.edd.renderChart=e=>{(e=>{const{type:t}=e;return"pie"===t||"doughnut"===t})(e)?(e=>{const{target:t}=e;e.options.tooltips=(e=>({...i,enabled:!1,callbacks:{label:function(t,a){const{options:{datasets:o,otherLabel:n,otherBreakdown:s}}=e,i=a.datasets[t.datasetIndex],d=Object.values(o).find((e=>e.label&&e.label.toLowerCase()===i.label.toLowerCase())),c=i.data.reduce((function(e,t,a,o){return e+t})),l=i.data[t.index],p=r(l,d),u=Math.floor(l/c*100+.5),h=a.labels[t.index];return h===n&&s&&Object.keys(s).length>0?[`${h}: ${p} (${u}%)`,"","Breakdown:",...Object.entries(s).map((([e,t])=>`  â€¢ ${e}: ${r(t,d)} (${Math.floor(t/c*100+.5)}%)`))]:`${h}: ${p} (${u}%)`}}}))(e),new Chart(document.getElementById(t),e)})(e):"bar"===e.type?(e=>{const{target:t}=e;e.options.scales.yAxes.forEach((e=>{e.ticks.hasOwnProperty("formattingType")&&(e.ticks=d(e.ticks)),e.ticks.hasOwnProperty("hideNegativeTicks")&&e.ticks.hideNegativeTicks&&(e.afterTickToLabelConversion=function(e){for(let t=e.ticksAsNumbers.length-1;t>=0;t--)e.ticksAsNumbers[t]<0&&(e.ticksAsNumbers.splice(t,1),e.ticks.splice(t,1))})}));const a=e.options.labels||[],o=a.length>0,n={...e,data:{labels:o?a:void 0,datasets:e.data.datasets||[]},options:{...e.options,maintainAspectRatio:!1,tooltips:p(e),scales:{yAxes:[...e.options.scales.yAxes],xAxes:[{...e.options.scales.xAxes[0],ticks:{maxTicksLimit:o?a.length:12,autoSkip:!1,maxRotation:45}}]},legend:{display:!(o&&1===e.data.datasets.length)}}};delete n.options.labels;let s=document.getElementById(t);new Chart(s,n)})(e):c(e)}},9431:e=>{e.exports=function(e,t,a,o){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):0,r=void 0===o?",":o,i=void 0===a?".":a,d="";return d=(s?function(e,t){if(-1===(""+e).indexOf("e"))return+(Math.round(e+"e+"+t)+"e-"+t);var a=(""+e).split("e"),o="";return+a[1]+t>0&&(o="+"),(+(Math.round(+a[0]+"e"+o+(+a[1]+t))+"e-"+t)).toFixed(t)}(n,s).toString():""+Math.round(n)).split("."),d[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(d[1]||"").length<s&&(d[1]=d[1]||"",d[1]+=new Array(s-d[1].length+1).join("0")),d.join(i)}}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,a),s.exports}a(1669),a(6595);var o=a(1669),n=a(1669);"undefined"!=typeof postboxes&&/edd-reports/.test(pagenow)&&postboxes.add_postbox_toggles(pagenow);const s={init:function(){this.meta_boxes(),this.date_options(),this.customers_export()},meta_boxes:function(){o(".edd-reports-wrapper .postbox .handlediv").remove(),o(".edd-reports-wrapper .postbox").removeClass("closed"),setTimeout((function(){o(".edd-reports-wrapper .postbox .hndle").off("click.postboxes")}),1)},date_options:function(){o("select.edd-graphs-date-options").on("change",(function(e){const t=o(this),a=t.parent().siblings(".edd-date-range-options");"other"===t.val()?a.removeClass("screen-reader-text"):(a.addClass("screen-reader-text"),o(".edd-date-range-selected-date span").addClass("hidden"),o('.edd-date-range-selected-date span[data-range="'+t.val()+'"]').removeClass("hidden"))})),o(".edd-date-range-dates").on("click",(function(e){e.preventDefault(),o("select.edd-graphs-date-options").trigger("focus")}));const e=o(".edd-date-range-selected-relative-date"),t=o(".edd-date-range-relative-dropdown");o(".edd-graphs-date-options").on("change",(function(){var e=o(this).val(),a=o('.edd-date-range-selected-date span[data-range="'+e+'"]').data("default-relative-range");o(".edd-date-range-picker").attr("data-range",e),o(".edd-graphs-relative-date-options").val(a).trigger("change"),o.ajax({type:"GET",dataType:"html",url:ajaxurl,data:{action:"edd_reports_get_relative_date_ranges",range:e,relative_range:a},beforeSend:function(){t.html('<div class="spinner"></div>').addClass("loading")},success:function(e){t.html(e)}}).fail((function(e){window.console&&window.console.log&&console.log(e)})).done((function(e){t.remove(".spinner"),t.removeClass("loading")}))})),e.on("click",(function(e){e.preventDefault(),o(this).toggleClass("opened")})),o(document).on("click",".edd-date-range-relative-dropdown li",(function(){var e=o(this).data("range");o(".edd-graphs-relative-date-options").val(e).trigger("change")})),o(".edd-graphs-relative-date-options").on("change",(function(){var e=o(this).val(),t=o('.edd-date-range-relative-dropdown li[data-range="'+e+'"]'),a=t.find(".date-range-name").first().text();o(".edd-date-range-selected-relative-range-name").html(a),o(".edd-date-range-relative-dropdown li.active").removeClass("active"),t.addClass("active")})),o(document).on("click",(function(e){s.close_relative_ranges_dropdown(e.target)})),o(document).on("keydown",(function(e){"Escape"===e.key&&s.close_relative_ranges_dropdown()}))},close_relative_ranges_dropdown:function(e=!1){var t=o(".edd-date-range-selected-relative-date");if(!t.hasClass("opened"))return!1;!1!==e&&(t.is(e)||t.has(e).length)||t.removeClass("opened")},customers_export:function(){o("#edd_customer_export_download").on("change",(function(){const e=o(this),t=o("option:selected",e).val(),a=o("#edd_customer_export_option");if("0"===e.val()?a.show():a.hide(),0!==parseInt(t)){const e={action:"edd_check_for_download_price_variations",download_id:t,all_prices:!0};var n=o(".edd_price_options_select");o.post(ajaxurl,e,(function(e){n.remove(),o("#edd_customer_export_download_chosen").after(e)}))}else n.remove()}))}};n(document).ready((function(e){s.init()}))})();